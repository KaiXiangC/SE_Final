<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>維護通知與公告</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            background-color: #feedaa;
            padding: 20px;
            border-radius: 10px;
            width: 42%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: hidden; /* 防止內容超出容器 */
            box-sizing: border-box; /* 確保內邊距不會改變容器大小 */
            
        }
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
            margin-left: 15%;
            width: 70%; /* 讓所有表單元素有統一的寬度 */
        }
        .form-group label {
            display: block;  /* 改為區塊顯示，讓標籤與輸入框在上下 */
            font-weight: bold;
            margin-bottom: 5px; /* 增加標籤與輸入框之間的間隔 */
        }
        .form-group textarea {
            width: 100%; /* 設置寬度為父容器的 100% */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            height: 300px; /* 設置高度，讓它可以顯示多行 */
            resize: vertical; /* 允許用戶調整高度 */
        }
        /* 按鈕設置為右對齊 */
        .submit-container {
            display: flex;
            justify-content: flex-end; /* 右對齊 */
            margin-top: 20px;
        }
        #table{
            display: flex;
            flex-direction: column; /* 垂直排列 */
            align-items: center; /* 水平居中對齊 */

        }
        table {
            width: 60%;
            border-collapse: collapse;
            margin-top: 20px;
            /*display: none;*/
        }

        td {
            padding: 15px;
            border: 1px solid gray;
            text-align: left;
        }

        /* 選擇每一行的第一個 <td> */
        tr td:first-child {
            width: 70%;
            text-align: center;
        }
        button {
            width: 20%;
            padding: 10px;
            background-color: #3b3a3a;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #555;
        }
        #switchb{
            display: flex;
            justify-content:center;
            margin-top: 30px;
            margin-bottom: 30px;
        }
        #history{
            display: inline-block;
        }
        #publish{
            display: none;
        }
        #maintenance_notice_Form {
            display: block;
        }
    </style>
</head>
<body>
    
    <div class="container">
        <h1>維護通知與公告</h1>
        <div id="switchb">
            <button id="history" onclick="SwitchButton()">歷史通知</button>
            <button id="publish" onclick="SwitchButton()">發布公告</button>
        </div>
        <form id="maintenance_notice_Form" method="POST" action="/maintenance_notice">
            <div class="form-group">
                <label for="content">公告內容:</label>
                <textarea id="content" name="content" required></textarea>
            </div>
            <div class="submit-container">
                <button type="submit">發布公告</button>
            </div>
        </form>
        <!--
        <div class="notices"></div>
            {% for notice in notices %}
                <div class="notice">
                    <div class="content">{{ notice.content }}</div>
                    <div class="timestamp">{{ notice.timestamp }}</div>
                </div>
            {% endfor %}
        </div>
        -->
        <div id="table">
            <table id="categoryTable" style="display: none;">
                <thead>
                    <tr>
                        <th>通知內容</th>
                        <th>通知時間</th>
                    </tr>
                </thead>
                <tbody id="categoryTableBody">
                    <!-- 資料會動態填充 -->
                </tbody>
            </table>
        </div>
        <!--
        <div id="table">
        <table id="categoryTable" style="display: none;">
            <thead>
                <tr>
                    <th>通知內容</th>
                    <th>通知時間</th>
                </tr>
            </thead>
            <tbody id="categoryTableBody">
                <tr>
                    <td>{{ notice.content }}</td>
                    <td>{{ notice.timestamp }}</td>
                </tr>
                <tr>
                    <td>{{ notice.content }}</td>
                    <td>{{ notice.timestamp }}</td>
                </tr>
                <tr>
                    <td>{{ notice.content }}</td>
                    <td>{{ notice.timestamp }}</td>
                </tr>
            </tbody>
        </table>
        </div>-->
    </div>
    <script>
        // 當點擊歷史通知按鈕時發送請求
        function SwitchButton() {
            const history = document.getElementById('history');
            const publish = document.getElementById('publish');
            const maintenance_notice_Form = document.getElementById('maintenance_notice_Form');
            const categoryTable = document.getElementById('categoryTable');
            const categoryTableBody = document.getElementById('categoryTableBody');
            
            if (history.style.display === 'inline-block' || history.style.display === '') {
                history.style.display = 'none';
                publish.style.display = 'inline-block';
                maintenance_notice_Form.style.display = 'none';
                categoryTable.style.display = 'inline-block';
        
                // 使用 AJAX 來獲取歷史通知資料
                fetch('/get_notices')
                    .then(response => response.json())
                    .then(data => {
                    if (data.notices.length === 0) {
                        const row = document.createElement('tr');
                        const cell = document.createElement('td');
                        cell.colSpan = 2;
                        cell.textContent = '暫無通知';
                        row.appendChild(cell);
                        categoryTableBody.appendChild(row);
                    }
                    const tableBody = document.getElementById('categoryTableBody');
                    tableBody.innerHTML = '';  // 清空表格內容
                    data.notices.forEach(notice => {
                        const row = document.createElement('tr');
                        const contentCell = document.createElement('td');
                        contentCell.textContent = notice.content;
                        const timestampCell = document.createElement('td');
                        timestampCell.textContent = notice.timestamp;

                        row.appendChild(contentCell);
                        row.appendChild(timestampCell);
                        tableBody.appendChild(row);
                    });
                })
                    .catch(error => console.error('獲取通知資料錯誤:', error));
        
            } else {
                history.style.display = 'inline-block';
                publish.style.display = 'none';
                maintenance_notice_Form.style.display = 'block';
                categoryTable.style.display = 'none';
            }
        }
    </script>
</body>
</html>
